<!DOCTYPE html>
<html lang="zh-Hant">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>數學挑戰賽 & 五子棋對抗</title>
    <link rel="stylesheet" href="css/style.css">
</head>

<body>

    <div class="container" id="main-menu-container">
        <h1>🎮 遊戲大廳</h1>
        <p>選擇你想挑戰的遊戲！</p>
        <div class="main-menu-grid">
            <button class="main-menu-btn" onclick="showMathGame()">
                <span style="font-size:3rem; margin-bottom:10px;">🧮</span>
                數學挑戰賽
            </button>
            <button class="main-menu-btn gomoku" onclick="showGomokuGame()">
                <span style="font-size:3rem; margin-bottom:10px;">⚫</span>
                五子棋對抗
            </button>
        </div>
    </div>

    <div class="container" id="math-game-container" style="display:none;">
        <!-- 首頁選單 (Math) -->
        <div id="home-menu">
            <h1>🏆 數學挑戰賽</h1>
            <p>打破紀錄，成為數學小博士！</p>
            <div class="menu-grid">
                <button class="mode-btn" onclick="startPractice('add')">➕ 加法 <span class="high-score" id="score-add">紀錄:
                        0</span></button>
                <button class="mode-btn" onclick="startPractice('subtract')">➖ 減法 <span class="high-score"
                        id="score-subtract">紀錄: 0</span></button>
                <button class="mode-btn" onclick="startPractice('multiply')">✖️ 乘法 <span class="high-score"
                        id="score-multiply">紀錄: 0</span></button>
                <button class="mode-btn" onclick="startPractice('divide')">➗ 除法 <span class="high-score"
                        id="score-divide">紀錄: 0</span></button>
                <button class="mode-btn mixed-mode" onclick="startPractice('mixed')">🚀 混合運算 (進階) <span
                        class="high-score" id="score-mixed">紀錄: 0</span></button>
            </div>
            <button class="back-btn" onclick="showMainMenu()" style="margin-top:30px;">⬅ 回遊戲大廳</button>
        </div>

        <!-- 練習區 -->
        <div id="practice-area">
            <div class="score-board">
                <div class="score-item">
                    <span>✨ 本次得分</span>
                    <span class="score-val" id="current-score">0</span>
                </div>
                <div class="score-item" style="text-align:right;">
                    <span>🏆 最高紀錄</span>
                    <span class="score-val" id="best-score">0</span>
                </div>
            </div>

            <h3 id="mode-title" style="color:#999; margin:0; font-size:1rem;">練習模式</h3>
            <div class="problem-display" id="problem-text"></div>
            <div><input type="number" id="answer-input" placeholder="?" readonly></div>

            <!-- Virtual Keypad -->
            <div class="keypad-container" id="keypad">
                <button class="key-btn" onclick="appendNumber(7)">7</button>
                <button class="key-btn" onclick="appendNumber(8)">8</button>
                <button class="key-btn" onclick="appendNumber(9)">9</button>
                <button class="key-btn" onclick="appendNumber(4)">4</button>
                <button class="key-btn" onclick="appendNumber(5)">5</button>
                <button class="key-btn" onclick="appendNumber(6)">6</button>
                <button class="key-btn" onclick="appendNumber(1)">1</button>
                <button class="key-btn" onclick="appendNumber(2)">2</button>
                <button class="key-btn" onclick="appendNumber(3)">3</button>
                <button class="key-btn action-key" onclick="clearInput()">C</button>
                <button class="key-btn" onclick="appendNumber(0)">0</button>
                <button class="key-btn action-key" onclick="backspace()">⌫</button>
                <button class="key-btn enter-key" id="keypad-enter" onclick="checkAnswer()">送出答案</button>
            </div>

            <!-- Result Panel (Hidden by default) -->
            <div id="result-panel" class="result-panel">
                <div class="result-message" id="result-msg">🎉 答對了！</div>
                <div class="result-score" id="result-score-text">+10 分</div>
                <button class="next-btn-large" onclick="generateProblem()">下一題 ➜</button>
            </div>

            <div id="mini-feedback"></div>
            <!-- Original check-btn hidden as we have one in keypad now, but keeping logic compatible -->
            <button class="action-btn" id="check-btn" onclick="checkAnswer()" style="display:none;">送出答案</button>
            <button class="explain-btn" id="explain-trigger" onclick="openModal()">💡 查看解題思路</button>
            <button class="action-btn" id="next-btn" onclick="generateProblem()"
                style="display:none; background-color: var(--primary-color);">下一題 ➜</button>
            <br>
            <button class="back-btn" onclick="goHome()">結束練習 (回選單)</button>
        </div>
    </div>

    <div class="container" id="gomoku-game-container" style="display:none;">
        <h1>⚫ 五子棋對抗 ⚪</h1>
        <div class="gomoku-status" id="gomoku-message">輪到你 (黑棋) 下棋</div>
        <div id="gomoku-board"></div>
        <div style="margin-top:20px;">
            <button class="action-btn" onclick="resetGomokuGame()"
                style="background-color: var(--secondary-color); width:auto; padding: 10px 25px; font-size:1rem;">重新開始</button>
            <br>
            <button class="back-btn" onclick="showMainMenu()">⬅ 回遊戲大廳</button>
        </div>
    </div>

    <div id="explanation-modal" class="modal-overlay" onclick="closeModalOutside(event)">
        <div class="modal-content">
            <div class="modal-header">
                <span class="modal-title">📝 解題思路</span>
                <button class="close-modal-btn" onclick="closeModal()">✕</button>
            </div>
            <div id="modal-body"></div>
            <div style="text-align: center; margin-top: 20px;">
                <button class="action-btn" onclick="closeModal()"
                    style="padding: 10px 30px; font-size: 1rem; width:auto;">我知道了！</button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/math_game.js"></script>
    <script src="js/gomoku.js"></script>
    <script src="js/main.js"></script>
</body>

</html>